## laradmin系统设计说明文档

### 当前版本 v1.0.0

### 数据字典

##### 用户表(user)

| 字段                | 数据类型    | 默认值 | 字段说明                      |
| ------------------- | ----------- | ------ | ----------------------------- |
| id                  | int(11)     |        | 用户id                        |
| username            | char(20)    |        | 用户名, 不可重复              |
| nickname            | char(20)    |        | 用户昵称可重复                |
| password            | char(32)    |        | 密码                          |
| salt                | char(6)     |        | 密码盐                        |
| mobile              | char(11)    |        | 手机                          |
| email               | char(32)    |        | 邮箱                          |
| avatar              | char(200)   |        | 用户头像                      |
| level               | tinyint(1)  | 0      | 等级                          |
| sex                 | tinyint(1)  | 0      | 性别：0 保密 1 男 2 女        |
| brithday            | date        |        | 生日                          |
| signature           | char(255)   |        | 签名                          |
| user_activation_key | char(60)    |        | 激活码                        |
| active_key_expire   | int(10)     |        | 激活码有效期时间戳            |
| fromuid             | int(11)     |        | 推荐人UID                     |
| token               | char(50)    |        | Token                         |
| user_status         | tinyint(1)  | 1      | 用户状态 0：禁用； 1：正常    |
| mobile_status       | tinyint(1)  | 0      | 手机号验证状态:0未验证1已验证 |
| email_status        | tinyint(1)  | 0      | 邮箱验证状态:0未验证1已验证   |
| user_type           | tinyint(1)  | 2      | 用户类型，1:admin ;2:会员     |
| foreign_id          | int(10)     | 0      | 用户外键id，备用              |
| successions         | int(10)     | 0      | 连续登录天数                  |
| maxsuccessions      | int(10)     | 0      | 最大连续登录天数              |
| loginfailure        | smallint(5) | 0      | 失败次数                      |
| last_login_ip       | varchar(16) |        | 最后登录ip                    |
| last_login_time     | datetime    |        | 最后登录时间                  |
| create_time         | datetime    |        | 注册时间                      |
| update_time         | datetime    |        | 更新时间                      |

##### 角色表(role)

| 字段        | 数据类型     | 默认值 | 字段说明    |
| ----------- | ------------ | ------ | ----------- |
| id          | int(11)      |        | ID          |
| name        | char(20)     |        | 角色名称    |
| pid         | int(10)      | 0      | 父角色ID    |
| status      | tinyint(1)   | 1      | 1开启 0禁用 |
| remark      | varchar(255) |        | 备注        |
| create_time | int(10)      | 0      | 创建时间    |
| update_time | int(10)      | 0      | 更新时间    |
| listorder   | int(3)       | 0      | 排序        |

##### 角色用户关联表(role_user)

| 字段    | 数据类型 | 默认值 | 字段说明 |
| ------- | -------- | ------ | -------- |
| role_id | int(11)  | 0      | 角色id   |
| user_id | int(11)  | 0      | 用户id   |

#####  用户余额表(user_account)

| 字段         | 数据类型      | 默认值 | 字段说明         |
| ------------ | ------------- | ------ | ---------------- |
| uid          | int(11)       |        | 用户ID           |
| money        | decimal(10,2) | 0.00   | 可用金额         |
| frozen_money | decimal(10,2) | 0.00   | 冻结金额, 单位分 |
| gold         | int(10)       | 0      | 金币(积分)数量   |

##### 用户提现记录表(user_cashout)

| 字段       | 数据类型      | 默认值 | 字段说明                                     |
| ---------- | ------------- | ------ | -------------------------------------------- |
| id         | int(10)       |        | ID                                           |
| uid        | int(10)       | 0      | 用户ID                                       |
| amount     | decimal(10,2) | 0.00   | 提现总额                                     |
| fee        | decimal(10,2) | 0.00   | 手续费                                       |
| bank       | varchar(20)   |        | 银行                                         |
| account    | varchar(60)   |        | 银行账户                                     |
| realname   | char(10)      |        | 姓名                                         |
| create_at  | datetime      |        | 创建时间                                     |
| pay_status | tinyint(1)    | 0      | 转账状态: 0:-, 1未支付2已支付                |
| pay_uid    | int(11)       | 0      | 打卡人员ID                                   |
| pay_msg    | varchar(200)  |        | 支付备注                                     |
| pay_at     | datetime      |        | 打款时间                                     |
| mod_status | tinyint(1)    | 0      | 审核状态: 0待审核1审核中2审核通过4审核未通过 |
| mod_msg    | varchar(200)  |        | 审核结果                                     |
| mod_uid    | int(11)       | 0      | 审核人员ID                                   |
| remark     | varchar(200)  |        | 管理备注                                     |
| mod_at     | datetime      |        | 审核时间                                     |
| err_msg    | varchar(255)  |        | 错误信息                                     |

##### 财务流水表 (user_finance)

| 字段          | 数据类型      | 默认值 | 字段说明             |
| ------------- | ------------- | ------ | -------------------- |
| id            | int(11)       |        | ID                   |
| uid           | int(11)       |        | 用户ID               |
| money         | decimal(10,2) | 0.00   | 金额                 |
| type          | tinyint(1)    |        | 财务类型:1消费,2充值 |
| category      | varchar(50)   |        | 消费和充值方式       |
| accountbefore | decimal(10,2) | 0.00   | 记录产生前余额       |
| accountafter  | decimal(10,2) | 0.00   | 记录产生后余额       |
| orderid       | int(10)       |        | 对应订单ID           |
| remark        | varchar(255)  |        | 备注                 |
| create_at     | datatime      |        | 创建时间             |

#####  积分/金币流水表 (user_gold_log)

| 字段       | 数据类型     | 默认值 | 字段说明             |
| ---------- | ------------ | ------ | -------------------- |
| id         | int(10)      |        | ID                   |
| uid        | int(10)      |        | 用户ID               |
| gold       | mediumint(8) |        | 积分/金币记录        |
| type       | tinyint(3)   |        | 积分类型:1奖励,2消耗 |
| category   | varchar(32)  |        | 类型                 |
| source     | varchar(50)  |        | 奖励/消耗方式        |
| sourceid   | varchar(20)  |        | 单号ID               |
| goldbefore | int(10)      |        | 记录产生前余额       |
| goldafter  | int(10)      |        | 记录产生后余额       |
| remark     | varchar(255) |        | 备注                 |
| create_at  | datetime     |        | 创建时间             |

##### 充值表(user_payment)

| 字段       | 数据类型      | 默认值 | 字段说明              |
| ---------- | ------------- | ------ | --------------------- |
| id         | int(10)       |        | ID                    |
| uid        | int(10)       | 0      | 用户id                |
| type       | varchar(18)   |        | 在线充值方式          |
| total      | decimal(10,2) | 0.00   | 充值金额,单位为分     |
| real_total | decimal(10,2) | 0.00   | 实际充值金额,单位为分 |
| trade_no   | varchar(60)   |        | 订单编号              |
| subject    | varchar(60)   |        | 商品                  |
| detail     | varchar(255)  |        | 详情                  |
| pay_sn     | varchar(60)   |        | 支付订单编号          |
| pay_from   | varchar(32)   |        | 订单来源              |
| orderid    | varchar(32)   |        | 本站订单ID            |
| status     | tinyint(3)    | 0      | 0未支付1已支付2失败   |
| create_at  | datetime      |        | 创建时间              |
| paid_at    | datetime      |        | 支付时间              |
| log        | text          |        | 日志信息              |

##### 支付方式表(user_payment_config)

| 字段   | 数据类型    | 默认值 | 字段说明                                     |
| ------ | ----------- | ------ | -------------------------------------------- |
| id     | int(10)     |        | ID                                           |
| type   | varchar(32) |        | 支付类型:wechat 微信支付, alipay: 支付宝支付 |
| name   | varchar(16) |        | 名称                                         |
| config | TEXT        |        | 配置项目, serialize序列化存储                |
| enable | tinyint(1)  | 0      | 1启用0禁用                                   |
| remark | TEXT        |        | 支付说明                                     |
| status | tinyint(1)  | 0      | 1可见0隐藏                                   |

##### 用户登录记录表(user_login_log)

| 字段        | 数据类型   | 默认值 | 字段说明             |
| ----------- | ---------- | ------ | -------------------- |
| ip          | char(15)   |        | 登录ip/主键          |
| uid         | int(10)    | 0      | 用户id/主键          |
| status      | tinyint(1) | 0      | 登录状态 1成功 0失败 |
| create_time | int(10)    | 0      | 登录时间             |

